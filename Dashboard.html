<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | buildfree.io</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Elegant, minimal design system */
        :root {
          /* Elegant, minimal color palette */
          --color-primary: #2d3142;
          --color-primary-light: #4f5d75;
          --color-secondary: #ef8354;
          --color-secondary-light: #f4a261;
          --color-accent: #bfc0c0;
          
          /* Background colors */
          --color-body: #ffffff;
          --color-bg-light: #f8f9fa;
          --color-bg-dark: #2d3142;
          
          /* Text colors */
          --color-white: #ffffff;
          --color-text: #2d3142;
          --color-text-light: #4f5d75;
          --color-text-muted: #bfc0c0;
          
          /* Border colors */
          --color-border: #e9ecef;
          --color-border-light: #f8f9fa;
          
          /* Status colors */
          --color-secondary-bg: #fef1eb;
          --color-secondary-border: #fad1c0;
          --color-success: #198754;
          --color-warning: #f59e0b;
          
          /* Other variables */
          --font-primary: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
          --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
          --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
          --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
          --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
          --spacing-xs: 0.25rem;
          --spacing-sm: 0.5rem;
          --spacing-md: 1rem;
          --spacing-lg: 1.5rem;
          --spacing-xl: 2rem;
          --spacing-2xl: 3rem;
          --spacing-3xl: 4rem;
          --radius-sm: 0.25rem;
          --radius-md: 0.375rem;
          --radius-lg: 0.5rem;
          --radius-xl: 0.75rem;
          --transition-base: all 0.2s ease;
        }
        
        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
        }
        
        body {
          font-family: var(--font-primary);
          color: var(--color-text);
          background-color: var(--color-body);
          line-height: 1.5;
          font-size: 0.8125rem;
          -webkit-font-smoothing: antialiased;
          -moz-osx-font-smoothing: grayscale;
        }

        /* Header */
        .header {
          position: sticky;
          top: 0;
          z-index: 50;
          background: rgba(255, 255, 255, 0.98);
          border-bottom: 1px solid var(--color-border);
        }

        .header-container {
          max-width: 1200px;
          margin: 0 auto;
          padding: 0 1.5rem;
          display: flex;
          align-items: center;
          justify-content: space-between;
          height: 3.5rem;
        }

        .logo {
          font-size: 1rem;
          font-weight: 600;
          color: var(--color-primary);
          text-decoration: none;
          letter-spacing: -0.025em;
        }

        .nav {
          display: flex;
          align-items: center;
          gap: 1.5rem;
        }

        .nav-link {
          font-size: 0.8125rem;
          color: var(--color-text-light);
          text-decoration: none;
          font-weight: 500;
          transition: var(--transition-base);
          padding: 0.375rem 0.625rem;
          border-radius: var(--radius-md);
        }

        .nav-link:hover {
          color: var(--color-text);
          background-color: var(--color-bg-light);
        }

        .nav-link.active {
          color: var(--color-secondary);
          font-weight: 600;
        }

        /* User menu */
        .user-menu {
          position: relative;
        }

        .user-menu-button {
          display: flex;
          align-items: center;
          background: none;
          border: none;
          cursor: pointer;
          color: var(--color-text);
          font-size: 0.8125rem;
          font-weight: 500;
          padding: 0.25rem 0.5rem;
          border-radius: var(--radius-md);
          transition: var(--transition-base);
        }

        .user-menu-button:hover {
          background-color: var(--color-bg-light);
        }

        .user-avatar {
          width: 1.75rem;
          height: 1.75rem;
          border-radius: 9999px;
          background-color: var(--color-primary);
          color: var(--color-white);
          display: flex;
          align-items: center;
          justify-content: center;
          margin-right: 0.5rem;
          font-weight: 600;
          font-size: 0.75rem;
        }

        .dropdown-menu {
          position: absolute;
          top: 100%;
          right: 0;
          margin-top: 0.25rem;
          background-color: var(--color-white);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          box-shadow: var(--shadow-lg);
          min-width: 180px;
          overflow: hidden;
          z-index: 10;
          display: none;
        }

        .dropdown-menu.active {
          display: block;
        }

        .dropdown-item {
          display: flex;
          align-items: center;
          padding: 0.625rem 0.875rem;
          color: var(--color-text);
          text-decoration: none;
          font-size: 0.8125rem;
          transition: var(--transition-base);
          background: none;
          border: none;
          cursor: pointer;
          width: 100%;
          text-align: left;
        }

        .dropdown-item:hover {
          background-color: var(--color-bg-light);
        }

        .dropdown-item svg {
          margin-right: 0.5rem;
          color: var(--color-text-light);
          width: 0.875rem;
          height: 0.875rem;
        }

        .dropdown-divider {
          height: 1px;
          background-color: var(--color-border);
          margin: 0.25rem 0;
        }

        /* Page header */
        .page-header {
          background: var(--color-white);
          border-bottom: 1px solid var(--color-border);
          padding: 2rem 0 1.5rem;
        }

        .container {
          max-width: 1200px;
          margin: 0 auto;
          padding: 0 1.5rem;
        }

        .page-title {
          font-size: 1.5rem;
          font-weight: 700;
          color: var(--color-primary);
          margin-bottom: 0.375rem;
          letter-spacing: -0.025em;
        }

        .page-description {
          color: var(--color-text-light);
          font-size: 0.875rem;
          max-width: 600px;
        }

        /* Main content */
        .main-content {
          max-width: 1200px;
          margin: 0 auto;
          padding: 1.5rem 0;
        }

        /* Cards */
        .card {
          background: var(--color-white);
          border: 1px solid var(--color-border);
          border-radius: var(--radius-lg);
          overflow: hidden;
          margin-bottom: 1.5rem;
          box-shadow: var(--shadow-md);
        }

        .card-header {
          padding: 1.25rem 1.5rem;
          border-bottom: 1px solid var(--color-border-light);
          background: var(--color-bg-light);
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .card-title {
          font-size: 0.875rem;
          font-weight: 600;
          color: var(--color-primary);
          display: flex;
          align-items: center;
          gap: 0.375rem;
        }

        .card-actions {
          display: flex;
          align-items: center;
          gap: 0.75rem;
        }

        .card-content {
          padding: 1.5rem;
        }

        /* Grid layouts */
        .grid {
          display: grid;
          gap: 1.5rem;
        }

        .grid-2 {
          grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        }

        .grid-3 {
          grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        }

        .grid-4 {
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        }

        /* Button styles */
        .btn {
          display: inline-flex;
          align-items: center;
          justify-content: center;
          border-radius: var(--radius-md);
          font-size: 0.75rem;
          font-weight: 500;
          padding: 0.5rem 1rem;
          transition: var(--transition-base);
          cursor: pointer;
          border: none;
        }

        .btn-primary {
          background-color: var(--color-secondary);
          color: var(--color-white);
        }

        .btn-primary:hover:not(:disabled) {
          background-color: var(--color-secondary-light);
          transform: translateY(-1px);
          box-shadow: var(--shadow-sm);
        }

        .btn-secondary {
          background-color: var(--color-white);
          color: var(--color-text);
          border: 1px solid var(--color-border);
        }

        .btn-secondary:hover:not(:disabled) {
          background-color: var(--color-bg-light);
          color: var(--color-primary);
          transform: translateY(-1px);
        }

        .btn-success {
          background-color: var(--color-success);
          color: var(--color-white);
        }

        .btn-success:hover:not(:disabled) {
          background-color: #157347;
          transform: translateY(-1px);
          box-shadow: var(--shadow-sm);
        }

        .btn-warning {
          background-color: var(--color-warning);
          color: var(--color-white);
        }

        .btn-warning:hover:not(:disabled) {
          background-color: #d97706;
          transform: translateY(-1px);
          box-shadow: var(--shadow-sm);
        }

        /* Templates */
        .template-card {
          background: var(--color-white);
          border: 1px solid var(--color-border-light);
          border-radius: var(--radius-lg);
          overflow: hidden;
          transition: var(--transition-base);
          cursor: pointer;
          box-shadow: var(--shadow-sm);
        }

        .template-card:hover {
          transform: translateY(-2px);
          box-shadow: var(--shadow-md);
        }

        .template-card.selected {
          border-color: var(--color-secondary);
          box-shadow: 0 0 0 2px rgba(239, 131, 84, 0.2);
        }

        .template-image {
          width: 100%;
          height: 160px;
          background: var(--color-bg-light);
          position: relative;
          overflow: hidden;
        }

        .template-image img {
          width: 100%;
          height: 100%;
          object-fit: cover;
        }

        .template-badge {
          position: absolute;
          top: 0.5rem;
          right: 0.5rem;
          width: 1.5rem;
          height: 1.5rem;
          background: var(--color-secondary);
          color: var(--color-white);
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 0.75rem;
          font-weight: 600;
        }

        .template-content {
          padding: 1rem;
        }

        .template-title {
          font-size: 0.875rem;
          font-weight: 600;
          color: var(--color-text);
          margin-bottom: 0.25rem;
        }

        .template-description {
          font-size: 0.8125rem;
          color: var(--color-text-light);
          margin-bottom: 0.75rem;
          line-height: 1.4;
        }

        .template-footer {
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .template-tag {
          background: var(--color-secondary-bg);
          color: var(--color-text-light);
          padding: 0.25rem 0.5rem;
          border-radius: var(--radius-sm);
          font-size: 0.75rem;
          font-weight: 500;
        }

        /* Portfolio preview */
        .portfolio-preview {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 2rem;
          align-items: start;
        }

        .portfolio-info {
          display: flex;
          flex-direction: column;
          gap: 1rem;
        }

        .portfolio-link-group {
          display: flex;
          gap: 0.5rem;
        }

        .portfolio-link {
          flex: 1;
          padding: 0.75rem;
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          font-size: 0.8125rem;
          background: var(--color-bg-light);
          color: var(--color-text-light);
        }

        .copy-button {
          padding: 0.75rem;
          border: 1px solid var(--color-border);
          border-left: none;
          border-radius: 0 var(--radius-md) var(--radius-md) 0;
          background: var(--color-white);
          color: var(--color-text-light);
          cursor: pointer;
          transition: var(--transition-base);
        }

        .copy-button:hover {
          background: var(--color-bg-light);
        }

        .portfolio-iframe {
          width: 100%;
          height: 300px;
          border: 1px solid var(--color-border-light);
          border-radius: var(--radius-lg);
        }

        /* Page editing grid */
        .page-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: 1rem;
        }

        .page-card {
          background: var(--color-white);
          border: 1px solid var(--color-border-light);
          border-radius: var(--radius-lg);
          padding: 1.25rem;
          text-align: center;
          transition: var(--transition-base);
          cursor: pointer;
          box-shadow: var(--shadow-sm);
        }

        .page-card:hover {
          transform: translateY(-2px);
          box-shadow: var(--shadow-md);
        }

        .page-icon {
          width: 3rem;
          height: 3rem;
          background: var(--color-secondary-bg);
          border-radius: var(--radius-lg);
          display: flex;
          align-items: center;
          justify-content: center;
          margin: 0 auto 1rem;
          color: var(--color-secondary);
          font-size: 1.25rem;
        }

        .page-title-small {
          font-size: 0.875rem;
          font-weight: 600;
          color: var(--color-text);
          margin-bottom: 0.5rem;
        }

        .page-description {
          font-size: 0.8125rem;
          color: var(--color-text-light);
          margin-bottom: 1rem;
          line-height: 1.4;
        }

        /* Welcome screen */
        .welcome-screen {
          text-align: center;
          padding: 3rem 0;
          max-width: 600px;
          margin: 0 auto;
        }

        .welcome-icon {
          width: 4rem;
          height: 4rem;
          background: var(--color-secondary-bg);
          border-radius: var(--radius-lg);
          display: flex;
          align-items: center;
          justify-content: center;
          margin: 0 auto 1.5rem;
          color: var(--color-secondary);
          font-size: 1.75rem;
        }

        .welcome-title {
          font-size: 1.5rem;
          font-weight: 600;
          color: var(--color-text);
          margin-bottom: 1rem;
          letter-spacing: -0.025em;
        }

        .welcome-description {
          font-size: 1rem;
          color: var(--color-text-light);
          margin-bottom: 2rem;
          line-height: 1.6;
        }

        .welcome-features {
          background: var(--color-bg-light);
          border-radius: var(--radius-lg);
          padding: 1.5rem;
          margin-bottom: 2rem;
          border: 1px solid var(--color-border);
        }

        .feature-list {
          display: flex;
          flex-direction: column;
          gap: 0.75rem;
        }

        .feature-item {
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 0.5rem;
          font-size: 0.875rem;
          color: var(--color-text-light);
        }

        .feature-icon {
          color: var(--color-secondary);
          font-size: 1rem;
        }

        /* Modals */
        .modal-overlay {
          position: fixed;
          inset: 0;
          background: rgba(0, 0, 0, 0.5);
          backdrop-filter: blur(4px);
          z-index: 50;
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 1rem;
          opacity: 0;
          visibility: hidden;
          transition: all 0.15s ease;
        }

        .modal-overlay.active {
          opacity: 1;
          visibility: visible;
        }

        .modal {
          background: var(--color-white);
          border-radius: var(--radius-lg);
          box-shadow: var(--shadow-xl);
          max-width: 400px;
          width: 100%;
          transform: scale(0.95);
          transition: transform 0.15s ease;
          max-height: 90vh;
          overflow: hidden;
          display: flex;
          flex-direction: column;
        }

        .modal-overlay.active .modal {
          transform: scale(1);
        }

        .modal-large {
          max-width: 600px;
        }

        .modal-fullscreen {
          max-width: none;
          width: 95%;
          height: 95vh;
          max-height: none;
          border-radius: var(--radius-lg);
        }

        .modal-fullscreen .modal-body {
          flex: 1;
          overflow-y: auto;
          max-height: none;
        }

        .modal-header {
          padding: 1.5rem 1.5rem 0;
          display: flex;
          align-items: center;
          justify-content: space-between;
          flex-shrink: 0;
        }

        .modal-title {
          font-size: 1.125rem;
          font-weight: 600;
          color: var(--color-text);
        }

        .modal-close {
          width: 2rem;
          height: 2rem;
          border: none;
          background: none;
          border-radius: var(--radius-sm);
          color: var(--color-text-muted);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          transition: var(--transition-base);
        }

        .modal-close:hover {
          background: var(--color-bg-light);
          color: var(--color-text);
        }

        .modal-body {
          padding: 1.5rem;
          overflow-y: auto;
          max-height: 60vh;
        }

        .modal-footer {
          padding: 0 1.5rem 1.5rem;
          display: flex;
          justify-content: space-between;
          align-items: center;
          gap: 1rem;
          flex-shrink: 0;
        }

        /* Forms */
        .form-group {
          margin-bottom: 1rem;
        }

        .form-label {
          display: block;
          font-size: 0.8125rem;
          font-weight: 500;
          color: var(--color-text);
          margin-bottom: 0.5rem;
        }

        .form-input {
          width: 100%;
          padding: 0.75rem;
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          font-size: 0.875rem;
          transition: var(--transition-base);
        }

        .form-input:focus {
          outline: none;
          border-color: var(--color-secondary);
          box-shadow: 0 0 0 2px rgba(239, 131, 84, 0.1);
        }

        .form-textarea {
          resize: vertical;
          min-height: 120px;
        }

        /* Upload area */
        .upload-area {
          border: 2px dashed var(--color-border);
          border-radius: var(--radius-lg);
          padding: 2rem;
          text-align: center;
          background: var(--color-bg-light);
          cursor: pointer;
          transition: var(--transition-base);
        }

        .upload-area:hover {
          border-color: var(--color-secondary);
          background: #f8f9fa;
        }

        .upload-icon {
          font-size: 2rem;
          color: var(--color-secondary);
          margin-bottom: 1rem;
        }

        .upload-text {
          font-size: 0.875rem;
          font-weight: 500;
          color: var(--color-text);
          margin-bottom: 0.25rem;
        }

        .upload-hint {
          font-size: 0.8125rem;
          color: var(--color-text-light);
        }

        /* Alerts */
        .alert {
          padding: 0.75rem 1rem;
          border-radius: var(--radius-md);
          margin-bottom: 1rem;
          font-size: 0.8125rem;
        }

        .alert-warning {
          background: #fef3c7;
          border: 1px solid #f59e0b;
          color: #92400e;
        }

        .alert-success {
          background: #d1fae5;
          border: 1px solid #10b981;
          color: #065f46;
        }

        .alert-error {
          background: #fee2e2;
          border: 1px solid #ef4444;
          color: #991b1b;
        }

        /* Steps indicator */
        .steps {
          display: flex;
          justify-content: space-between;
          margin-bottom: 2rem;
          position: relative;
        }

        .steps::before {
          content: '';
          position: absolute;
          top: 1rem;
          left: 1rem;
          right: 1rem;
          height: 2px;
          background: var(--color-border);
          z-index: 0;
        }

        .step {
          display: flex;
          flex-direction: column;
          align-items: center;
          position: relative;
          z-index: 1;
        }

        .step-number {
          width: 2rem;
          height: 2rem;
          border-radius: 50%;
          background: var(--color-border);
          color: var(--color-text-muted);
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 0.875rem;
          font-weight: 600;
          margin-bottom: 0.5rem;
        }

        .step.active .step-number {
          background: var(--color-secondary);
          color: var(--color-white);
        }

        .step.completed .step-number {
          background: var(--color-success);
          color: var(--color-white);
        }

        .step-label {
          font-size: 0.8125rem;
          color: var(--color-text-light);
          text-align: center;
        }

        .step.active .step-label,
        .step.completed .step-label {
          color: var(--color-text);
          font-weight: 500;
        }

        /* Loading states */
        .loading {
          display: inline-flex;
          align-items: center;
          gap: 0.5rem;
        }

        .spinner {
          width: 1rem;
          height: 1rem;
          border: 2px solid currentColor;
          border-right-color: transparent;
          border-radius: 50%;
          animation: spin 1s linear infinite;
        }

        @keyframes spin {
          to {
            transform: rotate(360deg);
          }
        }

        /* Notifications */
        .notification {
          position: fixed;
          top: 1rem;
          right: 1rem;
          background: var(--color-success);
          color: var(--color-white);
          padding: 0.75rem 1rem;
          border-radius: var(--radius-md);
          box-shadow: var(--shadow-lg);
          z-index: 60;
          transform: translateX(100%);
          transition: transform 0.3s ease;
          font-size: 0.875rem;
        }

        .notification.show {
          transform: translateX(0);
        }

        /* Template search and filters */
        .template-filters {
          display: flex;
          gap: 1rem;
          margin-bottom: 1.5rem;
          align-items: center;
          flex-wrap: wrap;
        }

        .search-input {
          flex: 1;
          min-width: 200px;
          padding: 0.75rem 1rem;
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          font-size: 0.875rem;
        }

        .filter-select {
          padding: 0.75rem 1rem;
          border: 1px solid var(--color-border);
          border-radius: var(--radius-md);
          font-size: 0.875rem;
          background: var(--color-white);
          min-width: 120px;
        }

        /* Footer Styles */
        .footer {
            background-color: var(--color-primary);
            color: var(--color-white);
            padding: 2.5rem 0 1.5rem;
            margin-top: 3rem;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .footer-section h3 {
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--color-white);
        }

        .footer-links {
            list-style: none;
            padding: 0;
        }

        .footer-links li {
            margin-bottom: 0.5rem;
        }

        .footer-links a {
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            font-size: 0.8125rem;
            transition: var(--transition-base);
        }

        .footer-links a:hover {
            color: var(--color-white);
        }

        .footer-bottom {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 1.5rem;
            text-align: center;
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.8125rem;
        }

        /* Utility classes */
        .hidden {
          display: none !important;
        }

        /* Responsive styles */
        @media (max-width: 768px) {
          .nav {
            display: none;
          }
          
          .container {
            padding: 0 1rem;
          }
          
          .portfolio-preview {
            grid-template-columns: 1fr;
            gap: 1.5rem;
          }
          
          .page-grid {
            grid-template-columns: 1fr;
          }
          
          .grid-2,
          .grid-3,
          .grid-4 {
            grid-template-columns: 1fr;
          }

          .modal-fullscreen {
            width: 98%;
            height: 98vh;
          }

          .template-filters {
            flex-direction: column;
            align-items: stretch;
          }

          .search-input,
          .filter-select {
            min-width: auto;
          }
          
          .footer-content {
              grid-template-columns: 1fr 1fr;
          }
        }

        @media (max-width: 480px) {
          .container {
            padding: 0 0.75rem;
          }
          
          .modal {
            margin: 1rem;
            max-width: none;
          }
          
          .modal-footer {
            flex-direction: column;
            gap: 0.75rem;
          }
          
          .modal-footer .btn {
            width: 100%;
          }

          .modal-fullscreen {
            width: 100%;
            height: 100vh;
            border-radius: 0;
            margin: 0;
          }
          
          .footer-content {
              grid-template-columns: 1fr;
          }
        }
    </style>
</head>

<body>
    <!-- Header -->
    <header class="header">
        <div class="header-container">
            <a href="index.html" class="logo">buildfree.io</a>
            
            <nav class="nav">
                <a href="dashboard.html" class="nav-link active">Dashboard</a>
                <a href="resume-changer.html" class="nav-link">Resume Changer</a>
                <a href="career-pages.html" class="nav-link">Career Pages</a>
                <a href="email-integration.html" class="nav-link">Email Integration</a>
                <a href="index.html#templates" class="nav-link">Templates</a>
                <a href="index.html#help" class="nav-link">Help</a>
            </nav>
            
            <!-- Auth navigation (will be toggled based on auth state) -->
            <div class="nav-actions" id="auth-nav" style="display: none;">
                <button class="btn btn-secondary" id="login-btn">Sign in</button>
                <button class="btn btn-primary" id="signup-btn">Get started</button>
            </div>
            
            <!-- User menu (when logged in) -->
            <div class="user-menu" id="user-menu" style="display: none;">
                <button class="user-menu-button" id="user-menu-btn">
                    <div class="user-avatar" id="user-avatar">J</div>
                    <span id="user-name">John Doe</span>
                    <svg width="12" height="12" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M4 6L8 10L12 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
                <div class="dropdown-menu" id="dropdown-menu">
                    <a href="profile.html" class="dropdown-item">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M8 8C9.65685 8 11 6.65685 11 5C11 3.34315 9.65685 2 8 2C6.34315 2 5 3.34315 5 5C5 6.65685 6.34315 8 8 8Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M2.5 14C2.5 11.5147 4.51472 9.5 7 9.5H9C11.4853 9.5 13.5 11.5147 13.5 14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Profile
                    </a>
                    <a href="resume-changer.html" class="dropdown-item">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M8.16683 1.16666H3.50016C3.19074 1.16666 2.89379 1.28957 2.6813 1.50837C2.46881 1.72716 2.3335 2.03188 2.3335 2.34999V11.65C2.3335 11.9681 2.46881 12.2728 2.6813 12.4916C2.89379 12.7104 3.19074 12.8333 3.50016 12.8333H10.5002C10.8096 12.8333 11.1066 12.7104 11.319 12.4916C11.5315 12.2728 11.6668 11.9681 11.6668 11.65V4.66666L8.16683 1.16666Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M8.1665 1.16666V4.66666H11.6665" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Resume Changer
                    </a>
                    <div class="dropdown-divider"></div>
                    <button class="dropdown-item" id="logout-btn">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M6 14H3.33333C2.97971 14 2.64057 13.8595 2.39052 13.6095C2.14048 13.3594 2 13.0203 2 12.6667V3.33333C2 2.97971 2.14048 2.64057 2.39052 2.39052C2.64057 2.14048 2.97971 2 3.33333 2H6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M10.6667 11.3333L14 8L10.6667 4.66667" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M14 8H6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Sign out
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Page Header -->
    <div class="page-header">
        <div class="container">
            <h1 class="page-title">Portfolio Dashboard</h1>
            <p class="page-description">
                Create and manage your professional portfolio with our intuitive builder.
            </p>
        </div>
    </div>

    <!-- Main Content -->
    <main class="container">
        <div class="main-content">
            <!-- Auth Welcome Screen -->
            <div id="auth-welcome" class="welcome-screen hidden">
                <div class="welcome-icon">
                    <svg width="28" height="28" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M16 7C16 9.20914 14.2091 11 12 11C9.79086 11 8 9.20914 8 7C8 4.79086 9.79086 3 12 3C14.2091 3 16 4.79086 16 7Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M12 14C8.13401 14 5 17.134 5 21H19C19 17.134 15.866 14 12 14Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <h1 class="welcome-title">Welcome to buildfree.io</h1>
                <p class="welcome-description">
                    Create your professional portfolio with our intuitive builder. 
                    Sign in to access your dashboard or create an account to get started.
                </p>
                <div class="welcome-features">
                    <div class="feature-list">
                        <div class="feature-item">
                            <svg class="feature-icon" width="16" height="16" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path d="M5 13L9 17L19 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            Professional templates
                        </div>
                        <div class="feature-item">
                            <svg class="feature-icon" width="16" height="16" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path d="M5 13L9 17L19 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            Resume changer with AI
                        </div>
                        <div class="feature-item">
                            <svg class="feature-icon" width="16" height="16" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path d="M5 13L9 17L19 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            Simple $12/month pricing
                        </div>
                    </div>
                </div>
                <div style="display: flex; gap: 1rem; justify-content: center;">
                    <button class="btn btn-secondary" id="login-btn-welcome">Sign In</button>
                    <button class="btn btn-primary" id="signup-btn-welcome">Get Started</button>
                </div>
            </div>

            <!-- Dashboard Content (when authenticated) -->
            <div id="dashboard-content" class="hidden">
                <!-- Loading State -->
                <div id="loading-state" class="card">
                    <div class="card-content" style="text-align: center; padding: 3rem;">
                        <div class="spinner" style="width: 2rem; height: 2rem; margin: 0 auto 1rem;"></div>
                        <p style="color: var(--color-text-light);">Loading your portfolio...</p>
                    </div>
                </div>

                <!-- No Portfolio State -->
                <div id="no-portfolio-state" class="hidden">
                    <div class="card">
                        <div class="card-content" style="text-align: center; padding: 3rem;">
                            <div style="width: 4rem; height: 4rem; background: var(--color-secondary-bg); border-radius: var(--radius-lg); display: flex; align-items: center; justify-content: center; margin: 0 auto 1.5rem; color: var(--color-secondary); font-size: 1.75rem;">
                                <svg width="28" height="28" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M19 16V3C19 2.46957 18.7893 1.96086 18.4142 1.58579C18.0391 1.21071 17.5304 1 17 1H7C6.46957 1 5.96086 1.21071 5.58579 1.58579C5.21071 1.96086 5 2.46957 5 3V21C5 21.5304 5.21071 22.0391 5.58579 22.4142C5.96086 22.7893 6.46957 23 7 23H14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M9 7H15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M9 11H15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M9 15H13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                            <h2 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 0.75rem;">Create Your Portfolio</h2>
                            <p style="color: var(--color-text-light); margin-bottom: 2rem; max-width: 400px; margin-left: auto; margin-right: auto;">You haven't created a portfolio yet. Choose a template to get started.</p>
                            <button class="btn btn-primary" id="create-portfolio-btn">
                                <svg width="16" height="16" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="margin-right: 0.5rem;">
                                    <path d="M12 5V19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                Choose Template
                            </button>
                        </div>
                    </div>

                    <!-- Templates Grid -->
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M2 2H14V14H2V2ZM2 6H14M6 2V14" stroke="currentColor" stroke-width="1.5"/>
                                </svg>
                                Available Templates
                            </h2>
                        </div>
                        <div class="card-content">
                            <div class="grid grid-3" id="templates-grid">
                                <!-- Templates will be loaded here -->
                                <div style="grid-column: 1 / -1; text-align: center; padding: 2rem;">
                                    <div class="spinner" style="margin: 0 auto 1rem;"></div>
                                    <p style="color: var(--color-text-light);">Loading templates...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Portfolio Exists State -->
                <div id="portfolio-exists-state" class="hidden">
                    <!-- Portfolio Overview -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M2 14V2C2 1.44772 2.44772 1 3 1H13C13.5523 1 14 1.44772 14 2V14L8 11L2 14Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                Your Portfolio
                            </div>
                        </div>
                        <div class="card-content">
                            <!-- Template Change Notice -->
                            <div id="template-change-notice" class="alert alert-warning hidden">
                                <strong>Template Changed:</strong> You've selected a new template. Click "Publish Changes" to make it live.
                            </div>

                            <div class="portfolio-preview">
                                <div class="portfolio-info">
                                    <div>
                                        <h3 style="font-size: 0.875rem; font-weight: 600; margin-bottom: 0.75rem; color: var(--color-text);">Portfolio Link</h3>
                                        <div class="portfolio-link-group">
                                            <input type="text" class="portfolio-link" id="portfolio-url" readonly>
                                            <button class="copy-button" id="copy-link-btn">
                                                <svg width="16" height="16" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                                    <path d="M8 5H6C4.89543 5 4 5.89543 4 7V19C4 20.1046 4.89543 21 6 21H16C17.1046 21 18 20.1046 18 19V17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                                    <path d="M19 9H10C8.89543 9 8 8.10457 8 7V5C8 3.89543 8.89543 3 10 3H16L20 7V7C20 8.10457 19.1046 9 18 9H19Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <div style="display: flex; gap: 0.75rem; flex-wrap: wrap;">
                                        <a href="#" class="btn btn-secondary" id="view-portfolio-btn" target="_blank">
                                            <svg width="16" height="16" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="margin-right: 0.5rem;">
                                                <path d="M10 12C10 12.5304 10.2107 13.0391 10.5858 13.4142C10.9609 13.7893 11.4696 14 12 14C12.5304 14 13.0391 13.7893 13.4142 13.4142C13.7893 13.0391 14 12.5304 14 12C14 11.4696 13.7893 10.9609 13.4142 10.5858C13.0391 10.2107 12.5304 10 12 10C11.4696 10 10.9609 10.2107 10.5858 10.5858C10.2107 10.9609 10 11.4696 10 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                                <path d="M21 12C18.6 16 15.6 18 12 18C8.4 18 5.4 16 3 12C5.4 8 8.4 6 12 6C15.6 6 18.6 8 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                            </svg>
                                            View Portfolio
                                        </a>
                                        <button class="btn btn-secondary" id="upload-image-btn">
                                            <svg width="16" height="16" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="margin-right: 0.5rem;">
                                                <path d="M4 16L8.586 11.414C8.96106 11.0391 9.46967 10.8284 10 10.8284C10.5303 10.8284 11.0389 11.0391 11.414 11.414L16 16M14 14L15.586 12.414C15.9611 12.0391 16.4697 11.8284 17 11.8284C17.5303 11.8284 18.0389 12.0391 18.414 12.414L20 14M14 8H14.01M6 20H18C18.5304 20 19.0391 19.7893 19.4142 19.4142C19.7893 19.0391 20 18.5304 20 18V6C20 5.46957 19.7893 4.96086 19.4142 4.58579C19.0391 4.21071 18.5304 4 18 4H6C5.46957 4 4.96086 4.21071 4.58579 4.58579C4.21071 4.96086 4 5.46957 4 6V18C4 18.5304 4.21071 19.0391 4.58579 19.4142C4.96086 19.7893 5.46957 20 6 20Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                            </svg>
                                            Profile Image
                                        </button>
                                        <button class="btn btn-secondary" id="switch-template-btn">
                                            <svg width="16" height="16" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="margin-right: 0.5rem;">
                                                <path d="M17 1L21 5L17 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                                <path d="M3 11V9C3 7.93913 3.42143 6.92172 4.17157 6.17157C4.92172 5.42143 5.93913 5 7 5H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                                <path d="M7 23L3 19L7 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                                <path d="M21 13V15C21 16.0609 20.5786 17.0783 19.8284 17.8284C19.0783 18.5786 18.0609 19 17 19H3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                            </svg>
                                            Change Template
                                        </button>
                                        <button class="btn btn-primary" id="edit-website-btn">
                                            <svg width="16" height="16" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="margin-right: 0.5rem;">
                                                <path d="M11 5H6C4.89543 5 4 5.89543 4 7V18C4 19.1046 4.89543 20 6 20H17C18.1046 20 19 19.1046 19 18V13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                                <path d="M17.5 3.50023C18.3284 2.67157 19.6716 2.67157 20.5 3.50023C21.3284 4.32889 21.3284 5.67178 20.5 6.50044L12 15.0002H9V12.0002L17.5 3.50023Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                            </svg>
                                            Edit Profile
                                        </button>
                                        <button class="btn btn-success" id="publish-changes-btn">
                                            <svg width="16" height="16" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="margin-right: 0.5rem;">
                                                <path d="M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                                <path d="M12 5L19 12L12 19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                            </svg>
                                            Publish Changes
                                        </button>
                                    </div>
                                </div>
                                
                                <div>
                                    <h3 style="font-size: 0.875rem; font-weight: 600; margin-bottom: 0.75rem; color: var(--color-text);">Portfolio Preview</h3>
                                    <iframe class="portfolio-iframe" id="portfolio-iframe"></iframe>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Page Editing -->
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M2 2H14V14H2V2Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M2 6H14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M6 14V6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                Edit Pages
                            </div>
                        </div>
                        <div class="card-content">
                            <div class="page-grid">
                                <div class="page-card" data-page="index">
                                    <div class="page-icon">
                                        <svg width="20" height="20" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M3 9L12 2L21 9V20C21 20.5304 20.7893 21.0391 20.4142 21.4142C20.0391 21.7893 19.5304 22 19 22H5C4.46957 22 3.96086 21.7893 3.58579 21.4142C3.21071 21.0391 3 20.5304 3 20V9Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                            <path d="M9 22V12H15V22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        </svg>
                                    </div>
                                    <h3 class="page-title-small">Home Page</h3>
                                    <p class="page-description">Edit your landing page and hero section</p>
                                    <button class="btn btn-primary">Edit Page</button>
                                </div>

                                <div class="page-card" data-page="about">
                                    <div class="page-icon">
                                        <svg width="20" height="20" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M12 11C14.2091 11 16 9.20914 16 7C16 4.79086 14.2091 3 12 3C9.79086 3 8 4.79086 8 7C8 9.20914 9.79086 11 12 11Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                            <path d="M12 14C8.13401 14 5 17.134 5 21H19C19 17.134 15.866 14 12 14Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        </svg>
                                    </div>
                                    <h3 class="page-title-small">About Page</h3>
                                    <p class="page-description">Update your biography and professional info</p>
                                    <button class="btn btn-primary">Edit Page</button>
                                </div>

                                <div class="page-card" data-page="projects">
                                    <div class="page-icon">
                                        <svg width="20" height="20" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M2 9C2 8.44772 2.44772 8 3 8H21C21.5523 8 22 8.44772 22 9V20C22 20.5523 21.5523 21 21 21H3C2.44772 21 2 20.5523 2 20V9Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                            <path d="M16 8V4C16 3.44772 15.5523 3 15 3H9C8.44772 3 8 3.44772 8 4V8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        </svg>
                                    </div>
                                    <h3 class="page-title-small">Projects Page</h3>
                                    <p class="page-description">Showcase your work and portfolio projects</p>
                                    <button class="btn btn-primary">Edit Page</button>
                                </div>

                                <div class="page-card" data-page="contact">
                                    <div class="page-icon">
                                        <svg width="20" height="20" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M4 4H20C21.1 4 22 4.9 22 6V18C22 19.1 21.1 20 20 20H4C2.9 20 2 19.1 2 18V6C2 4.9 2.9 4 4 4Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                            <path d="M22 6L12 13L2 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        </svg>
                                    </div>
                                    <h3 class="page-title-small">Contact Page</h3>
                                    <p class="page-description">Update your contact information and form</p>
                                    <button class="btn btn-primary">Edit Page</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Product</h3>
                    <ul class="footer-links">
                        <li><a href="dashboard.html">Dashboard</a></li>
                        <li><a href="resume-changer.html">Resume Changer</a></li>
                        <li><a href="career-pages.html">Career Pages</a></li>
                        <li><a href="email-integration.html">Email Integration</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3>Resources</h3>
                    <ul class="footer-links">
                        <li><a href="index.html#help">Help Center</a></li>
                        <li><a href="#">Job Search Tips</a></li>
                        <li><a href="#">Resume Templates</a></li>
                        <li><a href="#">Career Advice</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3>Company</h3>
                    <ul class="footer-links">
                        <li><a href="#">About</a></li>
                        <li><a href="#">Contact</a></li>
                        <li><a href="#">Privacy Policy</a></li>
                        <li><a href="#">Terms of Service</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3>Connect</h3>
                    <ul class="footer-links">
                        <li><a href="#">Twitter</a></li>
                        <li><a href="#">LinkedIn</a></li>
                        <li><a href="#">Instagram</a></li>
                        <li><a href="#">YouTube</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="footer-bottom">
                <p>&copy; 2025 buildfree.io. All rights reserved.</p>
            </div>
        </div>
    </footer>
    
    <!-- Login Modal -->
    <div class="modal-overlay" id="login-modal">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title">Welcome Back</h2>
                <button class="modal-close" id="login-close"></button>
            </div>
            <div class="modal-body">
                <div id="login-alert" class="alert alert-error hidden"></div>
                <form id="login-form">
                    <div class="form-group">
                        <label class="form-label" for="login-email">Email</label>
                        <input type="email" class="form-input" id="login-email" placeholder="you@example.com" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="login-password">Password</label>
                        <input type="password" class="form-input" id="login-password" placeholder="" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <p style="font-size: 0.8125rem; color: var(--color-text-light);">
                    Don't have an account? <a href="#" id="show-signup" style="color: var(--color-secondary); text-decoration: none;">Sign up</a>
                </p>
                <button class="btn btn-primary" id="login-submit">
                    <span id="login-text">Sign In</span>
                    <span id="login-loading" class="loading hidden">
                        <span class="spinner"></span>
                        Signing in...
                    </span>
                </button>
            </div>
        </div>
    </div>

    <!-- Register Modal -->
    <div class="modal-overlay" id="register-modal">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title">Create Account</h2>
                <button class="modal-close" id="register-close"></button>
            </div>
            <div class="modal-body">
                <div id="register-alert" class="alert alert-error hidden"></div>
                <form id="register-form">
                    <div class="form-group">
                        <label class="form-label" for="register-name">Full Name</label>
                        <input type="text" class="form-input" id="register-name" placeholder="John Doe" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="register-email">Email</label>
                        <input type="email" class="form-input" id="register-email" placeholder="you@example.com" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="register-password">Password</label>
                        <input type="password" class="form-input" id="register-password" placeholder="" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="register-confirm">Confirm Password</label>
                        <input type="password" class="form-input" id="register-confirm" placeholder="" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <p style="font-size: 0.8125rem; color: var(--color-text-light);">
                    Already have an account? <a href="#" id="show-login" style="color: var(--color-secondary); text-decoration: none;">Sign in</a>
                </p>
                <button class="btn btn-primary" id="register-submit">
                    <span id="register-text">Create Account</span>
                    <span id="register-loading" class="loading hidden">
                        <span class="spinner"></span>
                        Creating...
                    </span>
                </button>
            </div>
        </div>
    </div>

    <!-- Create Portfolio Modal -->
    <div class="modal-overlay" id="create-portfolio-modal">
        <div class="modal modal-large">
            <div class="modal-header">
                <h2 class="modal-title">Create Your Portfolio</h2>
                <button class="modal-close" id="create-close"></button>
            </div>
            <div class="modal-body">
                <!-- Steps -->
                <div class="steps">
                    <div class="step active" id="step-1">
                        <div class="step-number">1</div>
                        <div class="step-label">Template</div>
                    </div>
                    <div class="step" id="step-2">
                        <div class="step-number">2</div>
                        <div class="step-label">Profile Image</div>
                    </div>
                    <div class="step" id="step-3">
                        <div class="step-number">3</div>
                        <div class="step-label">Resume Data</div>
                    </div>
                </div>

                <!-- Step 1: Template -->
                <div id="step-template" class="step-content">
                    <h3 style="font-size: 1rem; font-weight: 600; margin-bottom: 1rem;">Selected Template</h3>
                    <div class="template-card selected" id="selected-template">
                        <div class="template-image">
                            <img id="selected-template-img" src="" alt="Selected template">
                            <div class="template-badge"></div>
                        </div>
                        <div class="template-content">
                            <h4 class="template-title" id="selected-template-name"></h4>
                            <div class="template-footer">
                                <span class="template-tag" id="selected-template-category"></span>
                                <button class="btn btn-secondary" id="change-template-btn">Change</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Profile Image -->
                <div id="step-image" class="step-content hidden">
                    <h3 style="font-size: 1rem; font-weight: 600; margin-bottom: 1rem;">Upload Profile Image</h3>
                    <div class="upload-area" id="image-upload-area">
                        <div class="upload-icon"></div>
                        <div class="upload-text">Click to upload profile image</div>
                        <div class="upload-hint">JPG, PNG or GIF (Max. 5MB)</div>
                        <input type="file" id="profile-image-input" accept="image/*" style="display: none;">
                    </div>
                    <div id="image-preview" class="hidden" style="text-align: center; margin-top: 1rem;">
                        <img id="preview-image" style="max-height: 200px; border-radius: var(--radius-lg);" alt="Preview">
                        <button class="btn btn-secondary" id="remove-image" style="margin-top: 0.5rem;">Remove</button>
                    </div>
                </div>

                <!-- Step 3: Resume Data -->
                <div id="step-resume" class="step-content hidden">
                    <h3 style="font-size: 1rem; font-weight: 600; margin-bottom: 1rem;">Resume Information</h3>
                    <p style="font-size: 0.8125rem; color: var(--color-text-light); margin-bottom: 1rem;">
                        Paste your resume or professional information below. This will be used to generate your portfolio content.
                    </p>
                    <textarea class="form-input form-textarea" id="resume-data" placeholder="Paste your resume, CV, or professional information here..." style="height: 200px;"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="prev-step-btn" style="display: none;">
                     Previous
                </button>
                <div style="flex: 1;"></div>
                <button class="btn btn-secondary" id="cancel-create-btn">Cancel</button>
                <button class="btn btn-primary" id="next-step-btn">
                    Next 
                </button>
                <button class="btn btn-primary hidden" id="create-submit-btn">
                    <span id="create-text">Create Portfolio</span>
                    <span id="create-loading" class="loading hidden">
                        <span class="spinner"></span>
                        Creating...
                    </span>
                </button>
            </div>
        </div>
    </div>

    <!-- Upload Image Modal -->
    <div class="modal-overlay" id="upload-image-modal">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title">Upload Profile Image</h2>
                <button class="modal-close" id="upload-close"></button>
            </div>
            <div class="modal-body">
                <div class="upload-area" id="upload-area">
                    <div class="upload-icon"></div>
                    <div class="upload-text">Click to upload profile image</div>
                    <div class="upload-hint">JPG, PNG or GIF (Max. 5MB)</div>
                    <input type="file" id="image-file-input" accept="image/*" style="display: none;">
                </div>
                <div id="upload-preview" class="hidden" style="text-align: center; margin-top: 1rem;">
                    <img id="upload-preview-img" style="max-height: 200px; border-radius: var(--radius-lg);" alt="Preview">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-upload-btn">Cancel</button>
                <button class="btn btn-primary" id="upload-submit-btn">
                    <span id="upload-text">Upload Image</span>
                    <span id="upload-loading" class="loading hidden">
                        <span class="spinner"></span>
                        Uploading...
                    </span>
                </button>
            </div>
        </div>
    </div>

    <!-- Switch Template Modal -->
    <div class="modal-overlay" id="switch-template-modal">
        <div class="modal modal-fullscreen">
            <div class="modal-header">
                <h2 class="modal-title">Change Template</h2>
                <button class="modal-close" id="switch-close"></button>
            </div>
            <div class="modal-body">
                <div class="alert alert-warning">
                    <strong>Note:</strong> Changing your template will preserve your content but apply a new design. You'll need to publish changes to make them live.
                </div>
                
                <!-- Search and Filter Controls -->
                <div class="template-filters">
                    <input type="text" class="search-input" id="template-search" placeholder="Search templates...">
                    <select class="filter-select" id="category-filter">
                        <option value="">All Categories</option>
                        <option value="Business">Business</option>
                        <option value="Creative">Creative</option>
                        <option value="Personal">Personal</option>
                        <option value="Technical">Technical</option>
                    </select>
                </div>
                
                <!-- Templates Grid -->
                <div class="grid grid-4" id="switch-templates-grid">
                    <div style="grid-column: 1 / -1; text-align: center; padding: 2rem;">
                        <div class="spinner" style="margin: 0 auto 1rem;"></div>
                        <p style="color: var(--color-text-light);">Loading templates...</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="cancel-switch-btn">Cancel</button>
                <button class="btn btn-primary" id="switch-submit-btn">
                    <span id="switch-text">Switch Template</span>
                    <span id="switch-loading" class="loading hidden">
                        <span class="spinner"></span>
                        Switching...
                    </span>
                </button>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <span id="notification-text"></span>
    </div>

    <script>
        // API Configuration
        const API_URL = '/api';
        
        // State
        let currentUser = null;
        let currentPortfolio = null;
        let allTemplates = [];
        let filteredTemplates = [];
        let selectedTemplate = null;
        let selectedTemplateData = null;
        let currentStep = 1;
        let profileImageFile = null;
        
        // DOM Elements
        const authNav = document.getElementById('auth-nav');
        const userMenu = document.getElementById('user-menu');
        const authWelcome = document.getElementById('auth-welcome');
        const dashboardContent = document.getElementById('dashboard-content');
        const loadingState = document.getElementById('loading-state');
        const noPortfolioState = document.getElementById('no-portfolio-state');
        const portfolioExistsState = document.getElementById('portfolio-exists-state');
        
        // Initialize
        document.addEventListener('DOMContentLoaded', init);
        
        function init() {
            setupEventListeners();
            checkAuth();
        }
        
        function setupEventListeners() {
            // User menu dropdown
            document.getElementById('user-menu-btn').addEventListener('click', toggleUserMenu);
            document.addEventListener('click', closeUserMenuOnOutsideClick);
            
            // Auth navigation
            document.getElementById('login-btn')?.addEventListener('click', () => showModal('login-modal'));
            document.getElementById('signup-btn')?.addEventListener('click', () => showModal('register-modal'));
            document.getElementById('login-btn-welcome')?.addEventListener('click', () => showModal('login-modal'));
            document.getElementById('signup-btn-welcome')?.addEventListener('click', () => showModal('register-modal'));
            
            // Modal navigation
            document.getElementById('show-signup')?.addEventListener('click', () => {
                hideModal('login-modal');
                showModal('register-modal');
            });
            document.getElementById('show-login')?.addEventListener('click', () => {
                hideModal('register-modal');
                showModal('login-modal');
            });
            
            // Modal close buttons
            document.querySelectorAll('.modal-close').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const modal = e.target.closest('.modal-overlay');
                    hideModal(modal.id);
                });
            });
            
            // Form submissions
            document.getElementById('login-submit')?.addEventListener('click', handleLogin);
            document.getElementById('register-submit')?.addEventListener('click', handleRegister);
            
            // Logout
            document.getElementById('logout-btn')?.addEventListener('click', handleLogout);
            
            // Portfolio creation
            document.getElementById('create-portfolio-btn')?.addEventListener('click', startPortfolioCreation);
            document.getElementById('next-step-btn')?.addEventListener('click', nextStep);
            document.getElementById('prev-step-btn')?.addEventListener('click', prevStep);
            document.getElementById('create-submit-btn')?.addEventListener('click', createPortfolio);
            document.getElementById('cancel-create-btn')?.addEventListener('click', () => hideModal('create-portfolio-modal'));
            
            // Image upload
            const imageUploadArea = document.getElementById('image-upload-area');
            if (imageUploadArea) {
                imageUploadArea.addEventListener('click', () => {
                    document.getElementById('profile-image-input').click();
                });
            }
            
            const profileImageInput = document.getElementById('profile-image-input');
            if (profileImageInput) {
                profileImageInput.addEventListener('change', handleImageSelect);
            }
            
            const removeImageBtn = document.getElementById('remove-image');
            if (removeImageBtn) {
                removeImageBtn.addEventListener('click', removeImage);
            }
            
            // Profile image upload
            document.getElementById('upload-image-btn')?.addEventListener('click', () => showModal('upload-image-modal'));
            
            const uploadArea = document.getElementById('upload-area');
            if (uploadArea) {
                uploadArea.addEventListener('click', () => {
                    document.getElementById('image-file-input').click();
                });
            }
            
            const imageFileInput = document.getElementById('image-file-input');
            if (imageFileInput) {
                imageFileInput.addEventListener('change', handleProfileImageSelect);
            }
            
            document.getElementById('upload-submit-btn')?.addEventListener('click', uploadProfileImage);
            document.getElementById('cancel-upload-btn')?.addEventListener('click', () => hideModal('upload-image-modal'));
            
            // Template switching
            document.getElementById('switch-template-btn')?.addEventListener('click', () => {
                loadSwitchTemplates();
                showModal('switch-template-modal');
            });
            document.getElementById('switch-submit-btn')?.addEventListener('click', switchTemplate);
            document.getElementById('cancel-switch-btn')?.addEventListener('click', () => hideModal('switch-template-modal'));
            
            // Template search and filtering
            const templateSearch = document.getElementById('template-search');
            if (templateSearch) {
                templateSearch.addEventListener('input', filterTemplates);
            }
            
            const categoryFilter = document.getElementById('category-filter');
            if (categoryFilter) {
                categoryFilter.addEventListener('change', filterTemplates);
            }
            
            // Portfolio actions
            document.getElementById('copy-link-btn')?.addEventListener('click', copyPortfolioLink);
            document.getElementById('edit-website-btn')?.addEventListener('click', editWebsite);
            document.getElementById('publish-changes-btn')?.addEventListener('click', publishChanges);
            
            // Page editing
            document.querySelectorAll('.page-card').forEach(card => {
                card.addEventListener('click', () => {
                    const page = card.dataset.page;
                    editPage(page);
                });
            });
            
            // Modal backdrop clicks
            document.querySelectorAll('.modal-overlay').forEach(overlay => {
                overlay.addEventListener('click', (e) => {
                    if (e.target === overlay) {
                        hideModal(overlay.id);
                    }
                });
            });
        }
        
        function toggleUserMenu() {
            const dropdown = document.getElementById('dropdown-menu');
            dropdown.classList.toggle('active');
        }
        
        function closeUserMenuOnOutsideClick(e) {
            const dropdown = document.getElementById('dropdown-menu');
            const userMenuBtn = document.getElementById('user-menu-btn');
            
            if (dropdown && dropdown.classList.contains('active') && 
                !dropdown.contains(e.target) && 
                !userMenuBtn.contains(e.target)) {
                dropdown.classList.remove('active');
            }
        }
        
        function showModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) modal.classList.add('active');
        }
        
        function hideModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) modal.classList.remove('active');
        }
        
        function showNotification(message) {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notification-text');
            
            if (notification && notificationText) {
                notificationText.textContent = message;
                notification.classList.add('show');
                
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }
        }
        
        function checkAuth() {
            const token = localStorage.getItem('token');
            const urlParams = new URLSearchParams(window.location.search);
            const authMode = urlParams.get('mode');
            const templateId = urlParams.get('template');
            
            if (token) {
                fetch(`${API_URL}/auth/profile`, {
                    headers: { 'Authorization': `Bearer ${token}` }
                })
                .then(response => response.json())
                .then(data => {
                    if (data.user) {
                        currentUser = data.user;
                        showAuthenticatedUI();
                        if (templateId) selectedTemplate = templateId;
                        checkUserPortfolio();
                    } else {
                        throw new Error('Invalid token');
                    }
                })
                .catch(() => {
                    localStorage.removeItem('token');
                    showUnauthenticatedUI(authMode, templateId);
                });
            } else {
                showUnauthenticatedUI(authMode, templateId);
            }
        }
        
        function showAuthenticatedUI() {
            if (authNav) authNav.style.display = 'none';
            if (userMenu) userMenu.style.display = 'block';
            if (authWelcome) authWelcome.classList.add('hidden');
            if (dashboardContent) dashboardContent.classList.remove('hidden');
            
            const userName = document.getElementById('user-name');
            const userAvatar = document.getElementById('user-avatar');
            
            if (userName && userAvatar && currentUser) {
                userName.textContent = currentUser.name;
                userAvatar.textContent = currentUser.name.charAt(0).toUpperCase();
            }
            
            const adminBadge = document.getElementById('admin-badge');
            if (adminBadge && currentUser && currentUser.role === 'admin') {
                adminBadge.classList.remove('hidden');
            }
        }
        
        function showUnauthenticatedUI(authMode, templateId) {
            if (authNav) authNav.style.display = 'flex';
            if (userMenu) userMenu.style.display = 'none';
            if (dashboardContent) dashboardContent.classList.add('hidden');
            if (authWelcome) authWelcome.classList.remove('hidden');
            
            if (templateId) selectedTemplate = templateId;
            
            if (authMode === 'login') {
                setTimeout(() => showModal('login-modal'), 500);
            } else if (authMode === 'signup') {
                setTimeout(() => showModal('register-modal'), 500);
            }
        }
        
        function handleLogin() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            if (!email || !password) {
                showAlert('login-alert', 'Please fill in all fields');
                return;
            }
            
            showLoading('login-text', 'login-loading');
            
            fetch(`${API_URL}/auth/login`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email, password })
            })
            .then(response => response.json())
            .then(data => {
                if (data.token) {
                    localStorage.setItem('token', data.token);
                    currentUser = data.user;
                    hideModal('login-modal');
                    showAuthenticatedUI();
                    checkUserPortfolio();
                } else {
                    showAlert('login-alert', data.message || 'Login failed');
                }
            })
            .catch(error => {
                showAlert('login-alert', 'Login failed. Please try again.');
            })
            .finally(() => {
                hideLoading('login-text', 'login-loading');
            });
        }
        
        function handleRegister() {
            const name = document.getElementById('register-name').value;
            const email = document.getElementById('register-email').value;
            const password = document.getElementById('register-password').value;
            const confirm = document.getElementById('register-confirm').value;
            
            if (!name || !email || !password || !confirm) {
                showAlert('register-alert', 'Please fill in all fields');
                return;
            }
            
            if (password !== confirm) {
                showAlert('register-alert', 'Passwords do not match');
                return;
            }
            
            showLoading('register-text', 'register-loading');
            
            fetch(`${API_URL}/auth/register`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ name, email, password })
            })
            .then(response => response.json())
            .then(data => {
                if (data.token) {
                    localStorage.setItem('token', data.token);
                    currentUser = data.user;
                    hideModal('register-modal');
                    showAuthenticatedUI();
                    checkUserPortfolio();
                } else {
                    showAlert('register-alert', data.message || 'Registration failed');
                }
            })
            .catch(error => {
                showAlert('register-alert', 'Registration failed. Please try again.');
            })
            .finally(() => {
                hideLoading('register-text', 'register-loading');
            });
        }
        
        function handleLogout() {
            localStorage.removeItem('token');
            window.location.href = 'index.html';
        }
        
        function checkUserPortfolio() {
            const token = localStorage.getItem('token');
            
            if (loadingState) loadingState.classList.remove('hidden');
            if (noPortfolioState) noPortfolioState.classList.add('hidden');
            if (portfolioExistsState) portfolioExistsState.classList.add('hidden');
            
            fetch(`${API_URL}/profolio/user-portfolio`, {
                headers: { 'Authorization': `Bearer ${token}` }
            })
            .then(response => response.json())
            .then(data => {
                if (loadingState) loadingState.classList.add('hidden');
                
                if (data.portfolioUrl) {
                    currentPortfolio = {
                        url: data.portfolioUrl,
                        editorUrl: data.editorUrl,
                        profileImageUrl: data.profileImageUrl,
                        templateId: data.templateId
                    };
                    showPortfolioExists();
                } else {
                    showNoPortfolio();
                }
            })
            .catch(error => {
                if (loadingState) loadingState.classList.add('hidden');
                showNoPortfolio();
            });
        }
        
        function showNoPortfolio() {
            if (noPortfolioState) noPortfolioState.classList.remove('hidden');
            if (portfolioExistsState) portfolioExistsState.classList.add('hidden');
            loadTemplates();
        }
        
        function showPortfolioExists() {
            if (portfolioExistsState) portfolioExistsState.classList.remove('hidden');
            if (noPortfolioState) noPortfolioState.classList.add('hidden');
            
            // Update portfolio info
            const portfolioUrl = document.getElementById('portfolio-url');
            const viewPortfolioBtn = document.getElementById('view-portfolio-btn');
            const portfolioIframe = document.getElementById('portfolio-iframe');
            
            if (portfolioUrl && currentPortfolio) {
                portfolioUrl.value = window.location.origin + currentPortfolio.url;
            }
            
            if (viewPortfolioBtn && currentPortfolio) {
                viewPortfolioBtn.href = currentPortfolio.url;
            }
            
            if (portfolioIframe && currentPortfolio) {
                portfolioIframe.src = currentPortfolio.url;
            }
        }
        
        function loadTemplates() {
            const grid = document.getElementById('templates-grid');
            if (!grid) return;
            
            fetch(`${API_URL}/profolio/templates`, {
                headers: { 'Authorization': `Bearer ${localStorage.getItem('token')}` }
            })
            .then(response => response.json())
            .then(data => {
                if (data.templates) {
                    allTemplates = data.templates;
                    renderTemplates(data.templates.slice(0, 6), grid);
                } else {
                    grid.innerHTML = '<p style="text-align: center; color: var(--color-text-light);">No templates found</p>';
                }
            })
            .catch(error => {
                grid.innerHTML = '<p style="text-align: center; color: var(--color-text-light);">Error loading templates</p>';
            });
        }
        
        function renderTemplates(templates, container) {
            container.innerHTML = templates.map(template => `
                <div class="template-card ${selectedTemplate === template.id ? 'selected' : ''}" data-id="${template.id}">
                    <div class="template-image">
                        <img src="${template.thumbnail_url || 'https://placehold.co/300x160/f1f3f4/6c757d?text=Template'}" alt="${template.name}">
                        ${selectedTemplate === template.id ? '<div class="template-badge"></div>' : ''}
                    </div>
                    <div class="template-content">
                        <h3 class="template-title">${template.name}</h3>
                        <p class="template-description">${template.description || 'Professional template'}</p>
                        <div class="template-footer">
                            <span class="template-tag">${template.category || 'General'}</span>
                            <button class="btn btn-primary btn-sm select-template" data-id="${template.id}">
                                ${selectedTemplate === template.id ? 'Selected' : 'Select'}
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
            
            // Add event listeners
            container.querySelectorAll('.template-card').forEach(card => {
                card.addEventListener('click', () => selectTemplate(card.dataset.id));
            });
        }
        
        function selectTemplate(templateId) {
            selectedTemplate = templateId;
            selectedTemplateData = allTemplates.find(t => t.id === templateId);
            
            // Update UI
            document.querySelectorAll('.template-card').forEach(card => {
                card.classList.toggle('selected', card.dataset.id === templateId);
                const badge = card.querySelector('.template-badge');
                const button = card.querySelector('.select-template');
                
                if (card.dataset.id === templateId) {
                    if (!badge) {
                        card.querySelector('.template-image').innerHTML += '<div class="template-badge"></div>';
                    }
                    if (button) button.textContent = 'Selected';
                } else {
                    if (badge) badge.remove();
                    if (button) button.textContent = 'Select';
                }
            });
        }
        
        function startPortfolioCreation() {
            if (!selectedTemplate) {
                showNotification('Please select a template first');
                return;
            }
            
            currentStep = 1;
            updateStepUI();
            
            // Update selected template info
            const selectedTemplateImg = document.getElementById('selected-template-img');
            const selectedTemplateName = document.getElementById('selected-template-name');
            const selectedTemplateCategory = document.getElementById('selected-template-category');
            
            if (selectedTemplateData && selectedTemplateImg && selectedTemplateName && selectedTemplateCategory) {
                selectedTemplateImg.src = selectedTemplateData.thumbnail_url || 'https://placehold.co/300x160/f1f3f4/6c757d?text=Template';
                selectedTemplateName.textContent = selectedTemplateData.name;
                selectedTemplateCategory.textContent = selectedTemplateData.category || 'General';
            }
            
            showModal('create-portfolio-modal');
        }
        
        function nextStep() {
            if (currentStep < 3) {
                currentStep++;
                updateStepUI();
            }
        }
        
        function prevStep() {
            if (currentStep > 1) {
                currentStep--;
                updateStepUI();
            }
        }
        
        function updateStepUI() {
            // Update step indicators
            for (let i = 1; i <= 3; i++) {
                const step = document.getElementById(`step-${i}`);
                if (step) {
                    if (i < currentStep) {
                        step.classList.add('completed');
                        step.classList.remove('active');
                    } else if (i === currentStep) {
                        step.classList.add('active');
                        step.classList.remove('completed');
                    } else {
                        step.classList.remove('active', 'completed');
                    }
                }
            }
            
            // Show/hide content
            const stepTemplate = document.getElementById('step-template');
            const stepImage = document.getElementById('step-image');
            const stepResume = document.getElementById('step-resume');
            
            if (stepTemplate) stepTemplate.classList.toggle('hidden', currentStep !== 1);
            if (stepImage) stepImage.classList.toggle('hidden', currentStep !== 2);
            if (stepResume) stepResume.classList.toggle('hidden', currentStep !== 3);
            
            // Update buttons
            const prevStepBtn = document.getElementById('prev-step-btn');
            const nextStepBtn = document.getElementById('next-step-btn');
            const createSubmitBtn = document.getElementById('create-submit-btn');
            
            if (prevStepBtn) prevStepBtn.style.display = currentStep === 1 ? 'none' : 'inline-flex';
            if (nextStepBtn) nextStepBtn.style.display = currentStep === 3 ? 'none' : 'inline-flex';
            if (createSubmitBtn) createSubmitBtn.classList.toggle('hidden', currentStep !== 3);
        }
        
        function handleImageSelect(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            if (!file.type.startsWith('image/')) {
                showNotification('Please select an image file');
                return;
            }
            
            if (file.size > 5 * 1024 * 1024) {
                showNotification('Image size should be less than 5MB');
                return;
            }
            
            profileImageFile = file;
            
            const reader = new FileReader();
            reader.onload = (e) => {
                const previewImage = document.getElementById('preview-image');
                const imagePreview = document.getElementById('image-preview');
                
                if (previewImage && imagePreview) {
                    previewImage.src = e.target.result;
                    imagePreview.classList.remove('hidden');
                }
            };
            reader.readAsDataURL(file);
        }
        
        function removeImage() {
            profileImageFile = null;
            
            const profileImageInput = document.getElementById('profile-image-input');
            const imagePreview = document.getElementById('image-preview');
            
            if (profileImageInput) profileImageInput.value = '';
            if (imagePreview) imagePreview.classList.add('hidden');
        }
        
        function handleProfileImageSelect(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            if (!file.type.startsWith('image/')) {
                showNotification('Please select an image file');
                return;
            }
            
            if (file.size > 5 * 1024 * 1024) {
                showNotification('Image size should be less than 5MB');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = (e) => {
                const uploadPreviewImg = document.getElementById('upload-preview-img');
                const uploadPreview = document.getElementById('upload-preview');
                
                if (uploadPreviewImg && uploadPreview) {
                    uploadPreviewImg.src = e.target.result;
                    uploadPreview.classList.remove('hidden');
                }
            };
            reader.readAsDataURL(file);
        }
        
        function uploadProfileImage() {
            const fileInput = document.getElementById('image-file-input');
            const file = fileInput?.files[0];
            
            if (!file) {
                showNotification('Please select an image');
                return;
            }
            
            showLoading('upload-text', 'upload-loading');
            
            const formData = new FormData();
            formData.append('image', file);
            
            fetch(`${API_URL}/profolio/upload-image`, {
                method: 'POST',
                headers: { 'Authorization': `Bearer ${localStorage.getItem('token')}` },
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    hideModal('upload-image-modal');
                    showNotification('Profile image uploaded successfully');
                    checkUserPortfolio();
                } else {
                    showNotification('Failed to upload image');
                }
            })
            .catch(error => {
                showNotification('Error uploading image');
            })
            .finally(() => {
                hideLoading('upload-text', 'upload-loading');
            });
        }
        
        function createPortfolio() {
            const resumeData = document.getElementById('resume-data')?.value;
            
            if (!resumeData || !resumeData.trim()) {
                showNotification('Please provide your resume information');
                return;
            }
            
            showLoading('create-text', 'create-loading');
            
            const formData = new FormData();
            formData.append('resumeData', resumeData);
            formData.append('templateId', selectedTemplate);
            
            if (profileImageFile) {
                formData.append('profileImage', profileImageFile);
            }
            
            fetch(`${API_URL}/profolio/generate`, {
                method: 'POST',
                headers: { 'Authorization': `Bearer ${localStorage.getItem('token')}` },
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    hideModal('create-portfolio-modal');
                    showNotification('Portfolio created successfully!');
                    checkUserPortfolio();
                } else {
                    showNotification('Failed to create portfolio');
                }
            })
            .catch(error => {
                showNotification('Error creating portfolio');
            })
            .finally(() => {
                hideLoading('create-text', 'create-loading');
            });
        }
        
        function loadSwitchTemplates() {
            const grid = document.getElementById('switch-templates-grid');
            if (!grid) return;
            
            if (allTemplates.length > 0) {
                filteredTemplates = allTemplates;
                renderSwitchTemplates(allTemplates, grid);
            } else {
                fetch(`${API_URL}/profolio/templates`, {
                    headers: { 'Authorization': `Bearer ${localStorage.getItem('token')}` }
                })
                .then(response => response.json())
                .then(data => {
                    if (data.templates) {
                        allTemplates = data.templates;
                        filteredTemplates = data.templates;
                        renderSwitchTemplates(data.templates, grid);
                    }
                });
            }
        }
        
        function filterTemplates() {
            const searchTerm = document.getElementById('template-search')?.value.toLowerCase();
            const categoryFilter = document.getElementById('category-filter')?.value;
            
            if (!searchTerm && !categoryFilter) {
                filteredTemplates = allTemplates;
            } else {
                filteredTemplates = allTemplates.filter(template => {
                    const matchesSearch = !searchTerm || 
                                    template.name.toLowerCase().includes(searchTerm) || 
                                    (template.description && template.description.toLowerCase().includes(searchTerm));
                    const matchesCategory = !categoryFilter || template.category === categoryFilter;
                    
                    return matchesSearch && matchesCategory;
                });
            }
            
            const grid = document.getElementById('switch-templates-grid');
            if (grid) renderSwitchTemplates(filteredTemplates, grid);
        }
        
        function renderSwitchTemplates(templates, container) {
            if (templates.length === 0) {
                container.innerHTML = '<div style="grid-column: 1 / -1; text-align: center; padding: 2rem;"><p style="color: var(--color-text-light);">No templates found matching your criteria</p></div>';
                return;
            }
            
            container.innerHTML = templates.map(template => `
                <div class="template-card ${currentPortfolio && currentPortfolio.templateId === template.id ? 'selected' : ''}" data-id="${template.id}">
                    <div class="template-image">
                        <img src="${template.thumbnail_url || 'https://placehold.co/300x160/f1f3f4/6c757d?text=Template'}" alt="${template.name}">
                        ${currentPortfolio && currentPortfolio.templateId === template.id ? '<div class="template-badge">Current</div>' : ''}
                        ${selectedTemplate === template.id && currentPortfolio && currentPortfolio.templateId !== template.id ? '<div class="template-badge"></div>' : ''}
                    </div>
                    <div class="template-content">
                        <h3 class="template-title">${template.name}</h3>
                        <div class="template-footer">
                            <span class="template-tag">${template.category || 'General'}</span>
                            <button class="btn btn-sm ${currentPortfolio && currentPortfolio.templateId === template.id ? 'btn-secondary' : selectedTemplate === template.id ? 'btn-success' : 'btn-primary'} switch-template" data-id="${template.id}">
                                ${currentPortfolio && currentPortfolio.templateId === template.id ? 'Current' : selectedTemplate === template.id ? 'Selected' : 'Select'}
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
            
            // Add event listeners
            container.querySelectorAll('.template-card').forEach(card => {
                card.addEventListener('click', () => {
                    if (currentPortfolio && currentPortfolio.templateId === card.dataset.id) return;
                    selectSwitchTemplate(card.dataset.id);
                });
            });
        }
        
        function selectSwitchTemplate(templateId) {
            selectedTemplate = templateId;
            
            // Update UI
            document.querySelectorAll('#switch-templates-grid .template-card').forEach(card => {
                const button = card.querySelector('.switch-template');
                const badge = card.querySelector('.template-badge');
                
                if (card.dataset.id === templateId) {
                    if (currentPortfolio && currentPortfolio.templateId === templateId) {
                        // This is the current template
                        return;
                    }
                    card.classList.add('selected');
                    if (button) {
                        button.textContent = 'Selected';
                        button.className = 'btn btn-sm btn-success switch-template';
                    }
                    // Add selected badge if not current
                    if (!badge || badge.textContent !== 'Current') {
                        const existingBadge = card.querySelector('.template-badge');
                        if (existingBadge) existingBadge.remove();
                        card.querySelector('.template-image').innerHTML += '<div class="template-badge"></div>';
                    }
                } else if (currentPortfolio && currentPortfolio.templateId === card.dataset.id) {
                    // This is the current template but not selected
                    card.classList.remove('selected');
                    if (button) {
                        button.textContent = 'Current';
                        button.className = 'btn btn-sm btn-secondary switch-template';
                    }
                } else {
                    // Regular unselected template
                    card.classList.remove('selected');
                    if (button) {
                        button.textContent = 'Select';
                        button.className = 'btn btn-sm btn-primary switch-template';
                    }
                    const existingBadge = card.querySelector('.template-badge');
                    if (existingBadge && existingBadge.textContent === '') {
                        existingBadge.remove();
                    }
                }
            });
        }
        
        function switchTemplate() {
            if (!selectedTemplate || (currentPortfolio && selectedTemplate === currentPortfolio.templateId)) {
                hideModal('switch-template-modal');
                return;
            }
            
            showLoading('switch-text', 'switch-loading');
            
            fetch(`${API_URL}/profolio/switch-template`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${localStorage.getItem('token')}`
                },
                body: JSON.stringify({ templateId: selectedTemplate })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    hideModal('switch-template-modal');
                    showNotification('Template switched! Remember to publish changes.');
                    
                    // Show template change notice
                    const templateChangeNotice = document.getElementById('template-change-notice');
                    if (templateChangeNotice) templateChangeNotice.classList.remove('hidden');
                    
                    // Update publish button
                    const publishBtn = document.getElementById('publish-changes-btn');
                    if (publishBtn) {
                        publishBtn.classList.remove('btn-success');
                        publishBtn.classList.add('btn-warning');
                        publishBtn.innerHTML = `
                            <svg width="16" height="16" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="margin-right: 0.5rem;">
                                <path d="M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M12 5L19 12L12 19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            Publish Template Changes
                        `;
                    }
                    
                    if (currentPortfolio) currentPortfolio.templateId = selectedTemplate;
                } else {
                    showNotification('Failed to switch template');
                }
            })
            .catch(error => {
                showNotification('Error switching template');
            })
            .finally(() => {
                hideLoading('switch-text', 'switch-loading');
            });
        }
        
        function copyPortfolioLink() {
            const linkInput = document.getElementById('portfolio-url');
            if (linkInput) {
                linkInput.select();
                document.execCommand('copy');
                showNotification('Portfolio link copied to clipboard');
            }
        }
        
        function editWebsite() {
            window.location.href = "profile-editor.html";
        }
        
        function editPage(page) {
            const token = localStorage.getItem('token');
            if (currentUser) {
                window.location.href = `/edit-portfolio/${currentUser.id}/${page}.html?token=${token}`;
            }
        }
        
        function publishChanges() {
            const publishBtn = document.getElementById('publish-changes-btn');
            if (publishBtn) {
                showLoading('publish-changes-btn', 'publish-loading');
            }
            
            fetch(`${API_URL}/profolio/regenerate`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${localStorage.getItem('token')}`
                },
                body: JSON.stringify({ templateId: currentPortfolio?.templateId })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    showNotification('Changes published successfully!');
                    
                    // Hide template change notice
                    const templateChangeNotice = document.getElementById('template-change-notice');
                    if (templateChangeNotice) templateChangeNotice.classList.add('hidden');
                    
                    // Reset publish button
                    if (publishBtn) {
                        publishBtn.classList.remove('btn-warning');
                        publishBtn.classList.add('btn-success');
                        publishBtn.innerHTML = `
                            <svg width="16" height="16" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style="margin-right: 0.5rem;">
                                <path d="M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M12 5L19 12L12 19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            Publish Changes
                        `;
                    }
                    
                    // Refresh iframe
                    const iframe = document.getElementById('portfolio-iframe');
                    if (iframe) iframe.src = iframe.src;
                } else {
                    showNotification('Failed to publish changes');
                }
            })
            .catch(error => {
                showNotification('Error publishing changes');
            })
            .finally(() => {
                hideLoading('publish-changes-btn', 'publish-loading');
            });
        }
        
        function showAlert(alertId, message) {
            const alert = document.getElementById(alertId);
            if (alert) {
                alert.textContent = message;
                alert.classList.remove('hidden');
            }
        }
        
        function showLoading(textId, loadingId) {
            const text = document.getElementById(textId);
            const loading = document.getElementById(loadingId);
            
            if (text) text.classList.add('hidden');
            if (loading) loading.classList.remove('hidden');
        }
        
        function hideLoading(textId, loadingId) {
            const text = document.getElementById(textId);
            const loading = document.getElementById(loadingId);
            
            if (loading) loading.classList.add('hidden');
            if (text) text.classList.remove('hidden');
        }
    </script>
</body>
</html>
